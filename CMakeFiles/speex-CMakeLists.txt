# compile speex static library on linux platform
#
# NOTE: delete the test files in `libspeex` directory, the files are:
# testenc.c, testenc_uwb.c, testenc_wb.c.
# because we need to find all *.c files in libspeex directory and comptile all
# to a static library, so we must delete them.

cmake_minimum_required(VERSION 3.4.1)

# These macros required
add_definitions(-DFIXED_POINT -DEXPORT= -UHAVE_CONFIG_H -DUSE_KISS_FFT)

set(SPEEX_ROOT_PATH    ${CMAKE_CURRENT_SOURCE_DIR})
set(SPEEX_INCLUDE_PATH ${SPEEX_ROOT_PATH}/include)
set(SPEEX_SRC_PATH     ${SPEEX_ROOT_PATH}/libspeex)

file(GLOB SPEEX_SRCS "${SPEEX_SRC_PATH}/*.c")

include_directories(
  ${SPEEX_INCLUDE_PATH}
  ${SPEEX_SRC_PATH})


add_library(speex STATIC ${SPEEX_SRCS})
# add_library(speex SHARED ${SPEEX_SRCS})


# test
link_directories(${CMAKE_CURRENT_SOURCE_DIR}/build)
add_executable(test_speex testenc.c)
target_link_libraries(test_speex speex m)
